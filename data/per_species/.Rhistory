))
subdt = data.frame()
subdt = rbind(subdt,data.frame(species,
major = table(major_introns$phase) / (nrow(major_introns)/ 3),
table(major_introns_busco$phase) / (nrow(major_introns_busco)/ 3)
))
subdt
dg = read.table("/home/fbenitiere/2023-alternative_splicing/data/Data1_supp.tab",header=T)
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / (nrow(major_introns)/ 3),
major_introns_busco = table(major_introns_busco$phase) / (nrow(major_introns_busco)/ 3)
))
}
subdt
View(subdt)
View(subdt)
library(ggplot2)
ggplot(subdt[grepl("0",subdt$major_introns.Var1)],aes(y=major_introns.Freq )) + geom_boxplot()
ggplot(subdt[grepl("0",subdt$major_introns.Var1),],aes(y=major_introns.Freq )) + geom_boxplot()
ggplot(subdt[grepl("0",subdt$major_introns.Var1),],aes(y=major_introns.Freq*3 )) + geom_boxplot()
ggplot(subdt[grepl("0",subdt$major_introns.Var1),],aes(y=major_introns.Freq/3 )) + geom_boxplot()
ggplot(subdt[grepl("0",subdt$major_introns.Var1),],aes(y=major_introns.Freq/3,group=major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq/3,group=major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq/3,group=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq/3,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq/3,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq/3,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq/3,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
tapply(major_introns$splice_variant_rate,major_introns$phase,mean)
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco)
subdt = data.frame()
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco)
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco)
))
subdt
subdt = data.frame()
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100
))
subdt
tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100
))
}
subdt
library(ggplot2)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq.Freq,x=major_introns.Freq_svr )) + geom_point() + facet_wrap(~phase)
subdt$major_introns_busco_svr
subdt$
ggplot(subdt,aes(y=major_introns.Freq.Freq,x=major_introns.Freq_svr )) + geom_point() + facet_wrap(~major_introns_busco.Var1)
subdt$
ggplot(subdt,aes(y=major_introns.Freq.Freq,x=major_introns.Freq_svr,fill=phase )) + geom_point()
subdt$
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns.Freq_svr,fill=phase )) + geom_point()
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns.Freq_svr,fill=phase )) + geom_point()
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns_svr,fill=phase )) + geom_point()
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns_svr,fill=phase )) + geom_point()
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns_svr,fill=major_introns.Var1 )) + geom_point()
ggplot(subdt,aes(y=major_introns.Freq,x=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_busco.Freq.Freq,x=major_introns_svr,fill=major_introns_busco.Freq.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_busco.Freq.Freq,x=major_introns_svr,fill=major_introns_busco.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_busco.Freq,x=major_introns_busco_svr,fill=major_introns_busco.Var1 )) + geom_point(pch=21)
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100
))
}
View(subdt)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_svr,fill=major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_svr,fill=as.character(major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
subdt[grepl("1",subdt$major_introns.Var1),]
subdt[grepl("1",subdt$major_introns.Var1),] - subdt[grepl("0",subdt$major_introns.Var1),]
subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ))) + geom_boxplot()
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns_busco.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
major_introns$have_abundant_sv
major_introns_busco_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_busco_have_abundant = major_introns_busco[major_introns_busco$have_abundant_sv == "True",]
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_busco_have_abundant = major_introns_busco[major_introns_busco$have_abundant_sv == "True",]
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100
major_introns_busco_have_abundant = table(major_introns_busco_have_abundant$phase) / nrow(major_introns_busco_have_abundant),
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_busco_have_abundant = major_introns_busco[major_introns_busco$have_abundant_sv == "True",]
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_busco_have_abundant = table(major_introns_busco_have_abundant$phase) / nrow(major_introns_busco_have_abundant),
major_introns_busco_have_abundant_svr = tapply(major_introns_busco_have_abundant$splice_variant_rate,major_introns_busco_have_abundant$phase,mean) * 100
))
}
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_busco_have_abundant = major_introns_busco[major_introns_busco$have_abundant_sv == "True",]
tapply(major_introns_busco_have_abundant$splice_variant_rate,major_introns_busco_have_abundant$phase,mean) * 100
table(major_introns_busco_have_abundant$phase) / nrow(major_introns_busco_have_abundant)
major_introns_busco_have_abundant
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_busco_have_abundant = major_introns_busco[major_introns_busco$have_abundant_sv == "True",]
if (length(unique(major_introns_busco_have_abundant$phase)) == 3){
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_busco_have_abundant = table(major_introns_busco_have_abundant$phase) / nrow(major_introns_busco_have_abundant),
major_introns_busco_have_abundant_svr = tapply(major_introns_busco_have_abundant$splice_variant_rate,major_introns_busco_have_abundant$phase,mean) * 100
))
}
}
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant,x=as.character(major_introns.Var1) )) + geom_boxplot()
subdt
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ))
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ),fill="red")
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq.Freq,y=major_introns_svr,fill=major_introns.Var1 )pch=21)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=21)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=21)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=22)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=24)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Freq.Var1),]$major_introns_have_abundant.Freq_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ),fill="red")
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=24)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(x=major_introns_busco.Freq,y=major_introns_busco_svr,fill=major_introns_busco.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=24)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(x=major_introns_busco.Freq,y=major_introns_busco_svr,fill=major_introns_busco.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_not_abundant = major_introns[major_introns$have_abundant_sv == "False",]
if (length(unique(major_introns_busco_have_abundant$phase)) == 3){
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_not_abundant = table(major_introns_not_abundant$phase) / nrow(major_introns_not_abundant),
major_introns_not_abundant_svr = tapply(major_introns_not_abundant$splice_variant_rate,major_introns_not_abundant$phase,mean) * 100
))
}
}
library(stringr)
library(dplyr)
library(tidyr)
dg = read.table("/home/fbenitiere/2023-alternative_splicing/data/Data1_supp.tab",header=T)
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_not_abundant = major_introns[major_introns$have_abundant_sv == "False",]
if (length(unique(major_introns_busco_have_abundant$phase)) == 3){
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_not_abundant = table(major_introns_not_abundant$phase) / nrow(major_introns_not_abundant),
major_introns_not_abundant_svr = tapply(major_introns_not_abundant$splice_variant_rate,major_introns_not_abundant$phase,mean) * 100
))
}
}
table(major_introns_not_abundant$phase) / nrow(major_introns_not_abundant)
tapply(major_introns_not_abundant$splice_variant_rate,major_introns_not_abundant$phase,mean) * 100
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_not_abundant = table(major_introns_not_abundant$phase) / nrow(major_introns_not_abundant),
major_introns_not_abundant_svr = tapply(major_introns_not_abundant$splice_variant_rate,major_introns_not_abundant$phase,mean) * 100
))
table(major_introns$phase) / nrow(major_introns)
tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100
table(major_introns_busco$phase) / nrow(major_introns_busco)
tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100
table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant_svr.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ),fill="red")
subdt
ggplot(subdt,aes(y=major_introns_not_abundant_.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ),fill="red")
ggplot(subdt,aes(y=major_introns_not_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot() +
geom_boxplot(data=subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) ),fill="red")
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=24)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
subdt = data.frame()
for (species in rev(dg$species)){print(species)
by_intron = read.delim(file=paste(pathData,species,".tab",sep=""), header=T , sep="\t",comment.char = "#")
by_intron = by_intron[!is.na(by_intron$phase),]
by_intron = by_intron[!grepl(",",by_intron$phase),]
fpkm_cov = read.delim(paste(pathData,"per_species/",species,"fpkm.tab.gz",sep=""),  sep="\t")
fpkm_cov = fpkm_cov[fpkm_cov$type == "gene" & grepl("gene_biotype=protein_coding" , fpkm_cov$attributes),]
major_introns = by_intron[by_intron$intron_class == "major" & by_intron$into_cds == "True" & by_intron$gene_id %in% fpkm_cov$gene_id,]
fpkm_cov = fpkm_cov[fpkm_cov$busco_metazoa ,]
CoverageBuscoExon = round(median(tapply(fpkm_cov$exon_coverage,fpkm_cov$gene_id,mean),na.rm=T)) # detection de la couverture médiane des gènes Busco
major_introns_busco = major_introns[major_introns$gene_id %in% fpkm_cov$gene_id,]
table(major_introns$phase) / (nrow(major_introns)/ 3)
major_introns_have_abundant = major_introns[major_introns$have_abundant_sv == "True",]
major_introns_not_abundant = major_introns[major_introns$have_abundant_sv == "False",]
if (length(unique(major_introns_have_abundant$phase)) == 3){
subdt = rbind(subdt,data.frame(species,
major_introns = table(major_introns$phase) / nrow(major_introns),
major_introns_svr = tapply(major_introns$splice_variant_rate,major_introns$phase,mean) * 100,
major_introns_busco = table(major_introns_busco$phase) / nrow(major_introns_busco),
major_introns_busco_svr = tapply(major_introns_busco$splice_variant_rate,major_introns_busco$phase,mean) * 100,
major_introns_have_abundant = table(major_introns_have_abundant$phase) / nrow(major_introns_have_abundant),
major_introns_have_abundant_svr = tapply(major_introns_have_abundant$splice_variant_rate,major_introns_have_abundant$phase,mean) * 100,
major_introns_not_abundant = table(major_introns_not_abundant$phase) / nrow(major_introns_not_abundant),
major_introns_not_abundant_svr = tapply(major_introns_not_abundant$splice_variant_rate,major_introns_not_abundant$phase,mean) * 100
))
}
}
View(dg)
rowwnames(dg) = dg$species
rownames(dg) = dg$species
library(ggplot2)
subdt$mean_as_proteincoding = dg[subdt$species,]$mean_as_proteincoding
ggplot(subdt,aes(y=major_introns.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_busco.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant.Freq,x=as.character(major_introns.Var1) )) + geom_boxplot()
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)+
geom_point(data=subdt,aes(x=major_introns_have_abundant.Freq,y=major_introns_svr,fill=major_introns.Var1 ),pch=24)
ggplot(subdt,aes(x=major_introns.Freq,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=mean_as_proteincoding,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=mean_as_proteincoding,y=major_introns_not_abundant_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=mean_as_proteincoding,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=mean_as_proteincoding,y=major_introns_busco_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(x=mean_as_proteincoding,y=major_introns_svr,fill=major_introns.Var1 )) + geom_point(pch=21)
ggplot(subdt,aes(y=major_introns_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_have_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
ggplot(subdt,aes(y=major_introns_not_abundant_svr,x=as.character(major_introns.Var1 ),fill=as.character(major_introns.Var1 ))) + geom_boxplot()
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("0",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr,
subdt[grepl("2",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr - subdt[grepl("1",subdt$major_introns_have_abundant.Var1),]$major_introns_have_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("0",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr,
subdt[grepl("2",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr - subdt[grepl("1",subdt$major_introns_not_abundant.Var1),]$major_introns_not_abundant_svr)
boxplot(subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("0",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr,
subdt[grepl("2",subdt$major_introns.Var1),]$major_introns_svr - subdt[grepl("1",subdt$major_introns.Var1),]$major_introns_svr)
